(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{23:e=>{"use strict";e.exports=function(e,t){return Object.keys(e).reduce(function(n,o){return n[o]=t(o,e[o]),n},{})}},99:(e,t,n)=>{"use strict";var o=n(9999),i=n(7062),r=n(4386),s=function(e,t,n){return n=n||{},this.options=o({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=e,this.data=t||[],this.list=new r(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(e){this.handleKeyUp(e.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(e){this.handleKeyDown(e)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(e){this.handlePaste(e)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};s.prototype.handleKeyUp=function(e){40!==e&&38!==e&&27!==e&&13!==e&&9!==e&&this.handleInputChange(this.el.value)},s.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},s.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},s.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(e.target.value)},100)}},s.prototype.handleInputChange=function(e){if(this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}).bind(this))},s.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},s.prototype.update=function(e){this.data=e,this.handleKeyUp()},s.prototype.clear=function(){this.data=[],this.list.clear()},s.prototype.normalize=function(e){return e=e.toLowerCase()},s.prototype.match=function(e,t){return e.indexOf(t)>-1},s.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},s.prototype.getCandidates=function(e){var t,n={pre:"<strong>",post:"</strong>",extract:(function(e){return this.getItemValue(e)}).bind(this)};e(this.options.filter?i.filter(this.query,this.data,n).map((function(e){return{original:e.original,string:this.render(e.original,e.string)}}).bind(this)):this.data.map((function(e){var t=this.render(e);return{original:e,string:t}}).bind(this)))},s.prototype.getItemValue=function(e){return e},s.prototype.render=function(e,t){if(t)return t;for(var n=e.original?this.getItemValue(e.original):this.getItemValue(e),o=this.normalize(n),i=o.lastIndexOf(this.query);i>-1;){var r=i+this.query.length;n=n.slice(0,i)+"<strong>"+n.slice(i,r)+"</strong>"+n.slice(r),i=o.slice(0,i).lastIndexOf(this.query)}return n},s.prototype.renderError=function(e){this.list.drawError(e)},e.exports=s},524:(e,t,n)=>{"use strict";n.d(t,{A:()=>eZ});var o={};n.r(o),n.d(o,{LAT_MAX:()=>b,LAT_MIN:()=>_,LAT_RENDERED_MAX:()=>x,LAT_RENDERED_MIN:()=>E,LNG_MAX:()=>O,LNG_MIN:()=>C,activeStates:()=>y,classes:()=>u,cursors:()=>l,events:()=>f,geojsonTypes:()=>d,interactions:()=>v,meta:()=>m,modes:()=>p,sources:()=>c,types:()=>h,updateActions:()=>g});var i={};n.r(i),n.d(i,{isActiveFeature:()=>es,isEnterKey:()=>ep,isEscapeKey:()=>ed,isFeature:()=>ec,isInactiveFeature:()=>ea,isOfMetaType:()=>ei,isShiftDown:()=>eh,isShiftMousedown:()=>er,isTrue:()=>ef,isVertex:()=>el,noTarget:()=>eu});var r={};n.r(r),n.d(r,{CommonSelectors:()=>i,ModeHandler:()=>s,StringSet:()=>A,constrainFeatureMovement:()=>eI,createMidPoint:()=>ev,createSupplementaryPoints:()=>e_,createVertex:()=>ey,doubleClickZoom:()=>eE,euclideanDistance:()=>k,featuresAt:()=>N,getFeatureAtAndSetCursors:()=>R,isClick:()=>F,isEventAtCoordinates:()=>eR,isTap:()=>D,mapEventToBoundingBox:()=>L,moveFeatures:()=>eL,sortFeatures:()=>I,stringSetsAreEqual:()=>e$,theme:()=>eo,toDenseArray:()=>K});let s=function(e,t){let n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},o={on(e,t,o){if(void 0===n[e])throw Error(`Invalid event type: ${e}`);n[e].push({selector:t,fn:o})},render(e){t.store.featureChanged(e)}},i=function(e,i){let r=n[e],s=r.length;for(;s--;){let e=r[s];if(e.selector(i)){e.fn.call(o,i)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(o),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(e){i("drag",e)},click(e){i("click",e)},mousemove(e){i("mousemove",e)},mousedown(e){i("mousedown",e)},mouseup(e){i("mouseup",e)},mouseout(e){i("mouseout",e)},keydown(e){i("keydown",e)},keyup(e){i("keyup",e)},touchstart(e){i("touchstart",e)},touchmove(e){i("touchmove",e)},touchend(e){i("touchend",e)},tap(e){i("tap",e)}}};var a=n(6027);let u={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},c={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},l={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},h={POLYGON:"polygon",LINE:"line_string",POINT:"point"},d={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},p={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},f={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},g={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},m={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},y={ACTIVE:"true",INACTIVE:"false"},v=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],_=-90,E=-85,b=90,x=85,C=-270,O=270,T={Point:0,LineString:1,MultiLineString:1,Polygon:2};function S(e,t){let n=T[e.geometry.type]-T[t.geometry.type];return 0===n&&e.geometry.type===d.POLYGON?e.area-t.area:n}let I=function(e){return e.map(e=>(e.geometry.type===d.POLYGON&&(e.area=a.geometry({type:d.FEATURE,property:{},geometry:e.geometry})),e)).sort(S).map(e=>(delete e.area,e))},L=function(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]};function w(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(let t=0,n=e.length;t<n;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}w.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},w.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},w.prototype.has=function(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])},w.prototype.values=function(){let e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((e,t)=>e.v-t.v).map(e=>e.k)},w.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};let A=w,M=[m.FEATURE,m.MIDPOINT,m.VERTEX],N={click:function(e,t,n){return P(e,t,n,n.options.clickBuffer)},touch:function(e,t,n){return P(e,t,n,n.options.touchBuffer)}};function P(e,t,n,o){if(null===n.map)return[];let i=e?L(e,o):t,r={};n.options.styles&&(r.layers=n.options.styles.map(e=>e.id).filter(e=>null!=n.map.getLayer(e)));let s=n.map.queryRenderedFeatures(i,r).filter(e=>-1!==M.indexOf(e.properties.meta)),a=new A,u=[];return s.forEach(e=>{let t=e.properties.id;a.has(t)||(a.add(t),u.push(e))}),I(u)}function R(e,t){let n=N.click(e,null,t),o={mouse:l.NONE};return n[0]&&(o.mouse=n[0].properties.active===y.ACTIVE?l.MOVE:l.POINTER,o.feature=n[0].properties.meta),-1!==t.events.currentModeName().indexOf("draw")&&(o.mouse=l.ADD),t.ui.queueMapClasses(o),t.ui.updateMapClasses(),n[0]}function k(e,t){let n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)}function F(e,t,n={}){let o=null!=n.fineTolerance?n.fineTolerance:4,i=null!=n.grossTolerance?n.grossTolerance:12,r=null!=n.interval?n.interval:500;e.point=e.point||t.point,e.time=e.time||t.time;let s=k(e.point,t.point);return s<o||s<i&&t.time-e.time<r}function D(e,t,n={}){let o=null!=n.tolerance?n.tolerance:25,i=null!=n.interval?n.interval:250;return e.point=e.point||t.point,e.time=e.time||t.time,k(e.point,t.point)<o&&t.time-e.time<i}let U=((e,t=21)=>(n=t)=>{let o="",i=0|n;for(;i--;)o+=e[Math.random()*e.length|0];return o})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32),B=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||U(),this.type=t.geometry.type};B.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},B.prototype.incomingCoords=function(e){this.setCoordinates(e)},B.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},B.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},B.prototype.setProperty=function(e,t){this.properties[e]=t},B.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:d.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},B.prototype.internal=function(e){let t={id:this.id,meta:m.FEATURE,"meta:type":this.type,active:y.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(let e in this.properties)t[`user_${e}`]=this.properties[e];return{type:d.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};let G=function(e,t){B.call(this,e,t)};G.prototype=Object.create(B.prototype),G.prototype.isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},G.prototype.updateCoordinate=function(e,t,n){3==arguments.length?this.coordinates=[t,n]:this.coordinates=[e,t],this.changed()},G.prototype.getCoordinate=function(){return this.getCoordinates()};let V=function(e,t){B.call(this,e,t)};V.prototype=Object.create(B.prototype),V.prototype.isValid=function(){return this.coordinates.length>1},V.prototype.addCoordinate=function(e,t,n){this.changed();let o=parseInt(e,10);this.coordinates.splice(o,0,[t,n])},V.prototype.getCoordinate=function(e){let t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},V.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)},V.prototype.updateCoordinate=function(e,t,n){let o=parseInt(e,10);this.coordinates[o]=[t,n],this.changed()};let j=function(e,t){B.call(this,e,t),this.coordinates=this.coordinates.map(e=>e.slice(0,-1))};j.prototype=Object.create(B.prototype),j.prototype.isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(e=>e.length>2)},j.prototype.incomingCoords=function(e){this.coordinates=e.map(e=>e.slice(0,-1)),this.changed()},j.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},j.prototype.addCoordinate=function(e,t,n){this.changed();let o=e.split(".").map(e=>parseInt(e,10));this.coordinates[o[0]].splice(o[1],0,[t,n])},j.prototype.removeCoordinate=function(e){this.changed();let t=e.split(".").map(e=>parseInt(e,10)),n=this.coordinates[t[0]];n&&(n.splice(t[1],1),n.length<3&&this.coordinates.splice(t[0],1))},j.prototype.getCoordinate=function(e){let t=e.split(".").map(e=>parseInt(e,10));return JSON.parse(JSON.stringify(this.coordinates[t[0]][t[1]]))},j.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))},j.prototype.updateCoordinate=function(e,t,n){this.changed();let o=e.split("."),i=parseInt(o[0],10),r=parseInt(o[1],10);void 0===this.coordinates[i]&&(this.coordinates[i]=[]),this.coordinates[i][r]=[t,n]};let q={MultiPoint:G,MultiLineString:V,MultiPolygon:j},$=(e,t,n,o,i)=>{let r=n.split("."),s=parseInt(r[0],10),a=r[1]?r.slice(1).join("."):null;return e[s][t](a,o,i)},z=function(e,t){if(B.call(this,e,t),delete this.coordinates,this.model=q[t.geometry.type],void 0===this.model)throw TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};function J(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}z.prototype=Object.create(B.prototype),z.prototype._coordinatesToFeatures=function(e){let t=this.model.bind(this);return e.map(e=>new t(this.ctx,{id:U(),type:d.FEATURE,properties:{},geometry:{coordinates:e,type:this.type.replace("Multi","")}}))},z.prototype.isValid=function(){return this.features.every(e=>e.isValid())},z.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()},z.prototype.getCoordinate=function(e){return $(this.features,"getCoordinate",e)},z.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===d.POLYGON?e.getCoordinates():e.coordinates)))},z.prototype.updateCoordinate=function(e,t,n){$(this.features,"updateCoordinate",e,t,n),this.changed()},z.prototype.addCoordinate=function(e,t,n){$(this.features,"addCoordinate",e,t,n),this.changed()},z.prototype.removeCoordinate=function(e){$(this.features,"removeCoordinate",e),this.changed()},z.prototype.getFeatures=function(){return this.features},J.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)},J.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((e,t)=>(void 0===e[t.feature_id]&&(e[t.feature_id]=!0,this._ctx.store.get(t.feature_id).changed()),e),{})},J.prototype.getSelected=function(){return this._ctx.store.getSelected()},J.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},J.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)},J.prototype.getFeature=function(e){return this._ctx.store.get(e)},J.prototype.select=function(e){return this._ctx.store.select(e)},J.prototype.deselect=function(e){return this._ctx.store.deselect(e)},J.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)},J.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)},J.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},J.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},J.prototype.setActionableState=function(e={}){let t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)},J.prototype.changeMode=function(e,t={},n={}){return this._ctx.events.changeMode(e,t,n)},J.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)},J.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)},J.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)},J.prototype.featuresAt=function(e,t,n="click"){if("click"!==n&&"touch"!==n)throw Error("invalid buffer type");return N[n](e,t,this._ctx)},J.prototype.newFeature=function(e){let t=e.geometry.type;return t===d.POINT?new G(this._ctx,e):t===d.LINE_STRING?new V(this._ctx,e):t===d.POLYGON?new j(this._ctx,e):new z(this._ctx,e)},J.prototype.isInstanceOf=function(e,t){if(e===d.POINT)return t instanceof G;if(e===d.LINE_STRING)return t instanceof V;if(e===d.POLYGON)return t instanceof j;if("MultiFeature"===e)return t instanceof z;throw Error(`Unknown feature class: ${e}`)},J.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)},J.prototype.onSetup=function(){},J.prototype.onDrag=function(){},J.prototype.onClick=function(){},J.prototype.onMouseMove=function(){},J.prototype.onMouseDown=function(){},J.prototype.onMouseUp=function(){},J.prototype.onMouseOut=function(){},J.prototype.onKeyUp=function(){},J.prototype.onKeyDown=function(){},J.prototype.onTouchStart=function(){},J.prototype.onTouchMove=function(){},J.prototype.onTouchEnd=function(){},J.prototype.onTap=function(){},J.prototype.onStop=function(){},J.prototype.onTrash=function(){},J.prototype.onCombineFeature=function(){},J.prototype.onUncombineFeature=function(){},J.prototype.toDisplayFeatures=function(){throw Error("You must overwrite toDisplayFeatures")};let H={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Z=Object.keys(H),K=function(e){return[].concat(e).filter(e=>void 0!==e)};function X(){let e=this;if(!(e.ctx.map&&void 0!==e.ctx.map.getSource(c.HOT)))return a();let t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});let n=[],o=[];e.isDirty?o=e.getAllIds():(n=e.getChangedIds().filter(t=>void 0!==e.get(t)),o=e.sources.hot.filter(t=>t.properties.id&&-1===n.indexOf(t.properties.id)&&void 0!==e.get(t.properties.id)).map(e=>e.properties.id)),e.sources.hot=[];let i=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(e=>{let t=e.properties.id||e.properties.parent;return -1===n.indexOf(t)});let r=i!==e.sources.cold.length||o.length>0;function s(n,o){let i=e.get(n).internal(t);e.ctx.events.currentModeRender(i,n=>{n.properties.mode=t,e.sources[o].push(n)})}function a(){e.isDirty=!1,e.clearChangedIds()}n.forEach(e=>s(e,"hot")),o.forEach(e=>s(e,"cold")),r&&e.ctx.map.getSource(c.COLD).setData({type:d.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(c.HOT).setData({type:d.FEATURE_COLLECTION,features:e.sources.hot}),a()}function W(e){let t;this._features={},this._featureIds=new A,this._selectedFeatureIds=new A,this._selectedCoordinates=[],this._changedFeatureIds=new A,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,X.call(this),this._emitSelectionChange&&(this.ctx.events.fire(f.SELECTION_CHANGE,{features:this.getSelected().map(e=>e.toGeoJSON()),points:this.getSelectedCoordinates().map(e=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:e.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(f.RENDER,{})}))},this.isDirty=!1}function Y(e,t={}){let n=e._selectedCoordinates.filter(t=>e._selectedFeatureIds.has(t.feature_id));e._selectedCoordinates.length===n.length||t.silent||(e._emitSelectionChange=!0),e._selectedCoordinates=n}W.prototype.createRenderBatch=function(){let e=this.render,t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}},W.prototype.setDirty=function(){return this.isDirty=!0,this},W.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)){let t=this.get(e);this.ctx.events.fire(f.CREATE,{features:[t.toGeoJSON()]})}return this},W.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)&&this.ctx.events.fire(f.UPDATE,{action:t.action?t.action:g.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this},W.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},W.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},W.prototype.getAllIds=function(){return this._featureIds.values()},W.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this},W.prototype.delete=function(e,t={}){let n=[];return K(e).forEach(e=>{this._featureIds.has(e)&&(this._featureIds.delete(e),this._selectedFeatureIds.delete(e),t.silent||-1!==n.indexOf(this._features[e])||n.push(this._features[e].toGeoJSON()),delete this._features[e],this.isDirty=!0)}),n.length&&this.ctx.events.fire(f.DELETE,{features:n}),Y(this,t),this},W.prototype.get=function(e){return this._features[e]},W.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])},W.prototype.select=function(e,t={}){return K(e).forEach(e=>{this._selectedFeatureIds.has(e)||(this._selectedFeatureIds.add(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))}),this},W.prototype.deselect=function(e,t={}){return K(e).forEach(e=>{this._selectedFeatureIds.has(e)&&(this._selectedFeatureIds.delete(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))}),Y(this,t),this},W.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this},W.prototype.setSelected=function(e,t={}){return e=K(e),this.deselect(this._selectedFeatureIds.values().filter(t=>-1===e.indexOf(t)),{silent:t.silent}),this.select(e.filter(e=>!this._selectedFeatureIds.has(e)),{silent:t.silent}),this},W.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this},W.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},W.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},W.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))},W.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(e=>({coordinates:this.get(e.feature_id).getCoordinate(e.coord_path)}))},W.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)},W.prototype.setFeatureProperty=function(e,t,n,o={}){this.get(e).setProperty(t,n),this.featureChanged(e,{silent:o.silent,action:g.CHANGE_PROPERTIES})},W.prototype.storeMapConfig=function(){v.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})},W.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})},W.prototype.getInitialConfigValue=function(e){return void 0===this._mapInitialConfig[e]||this._mapInitialConfig[e]};let Q=["mode","feature","mouse"],ee="#3bb2d0",et="#fbb03b",en="#fff",eo=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],et,ee],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],et,ee],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":en}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],et,ee]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":en}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":et}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":et}}];function ei(e){return function(t){let n=t.featureTarget;return!!n&&!!n.properties&&n.properties.meta===e}}function er(e){return!!e.originalEvent&&!!e.originalEvent.shiftKey&&0===e.originalEvent.button}function es(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===y.ACTIVE&&e.featureTarget.properties.meta===m.FEATURE}function ea(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===y.INACTIVE&&e.featureTarget.properties.meta===m.FEATURE}function eu(e){return void 0===e.featureTarget}function ec(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.meta===m.FEATURE}function el(e){let t=e.featureTarget;return!!t&&!!t.properties&&t.properties.meta===m.VERTEX}function eh(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}function ed(e){return 27===e.keyCode}function ep(e){return 13===e.keyCode}function ef(){return!0}function eg(e,t){this.x=e,this.y=t}eg.prototype={clone(){return new eg(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){let t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){let t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){let e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){let t=Math.cos(e),n=Math.sin(e),o=t*this.x-n*this.y,i=n*this.x+t*this.y;return this.x=o,this.y=i,this},_rotateAround(e,t){let n=Math.cos(e),o=Math.sin(e),i=t.x+n*(this.x-t.x)-o*(this.y-t.y),r=t.y+o*(this.x-t.x)+n*(this.y-t.y);return this.x=i,this.y=r,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:eg},eg.convert=function(e){if(e instanceof eg)return e;if(Array.isArray(e))return new eg(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new eg(+e.x,+e.y);throw Error("Expected [x, y] or {x, y} point format")};let em=function(e,t){let n=t.getBoundingClientRect();return new eg(e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0))};function ey(e,t,n,o){return{type:d.FEATURE,properties:{meta:m.VERTEX,parent:e,coord_path:n,active:o?y.ACTIVE:y.INACTIVE},geometry:{type:d.POINT,coordinates:t}}}function ev(e,t,n){let o=t.geometry.coordinates,i=n.geometry.coordinates;if(o[1]>x||o[1]<E||i[1]>x||i[1]<E)return null;let r={lng:(o[0]+i[0])/2,lat:(o[1]+i[1])/2};return{type:d.FEATURE,properties:{meta:m.MIDPOINT,parent:e,lng:r.lng,lat:r.lat,coord_path:n.properties.coord_path},geometry:{type:d.POINT,coordinates:[r.lng,r.lat]}}}let e_=function e(t,n={},o=null){let{type:i,coordinates:r}=t.geometry,s=t.properties&&t.properties.id,a=[];function u(e,t){let o="",i=null;e.forEach((e,r)=>{let u=null!=t?`${t}.${r}`:String(r),l=ey(s,e,u,c(u));if(n.midpoints&&i){let e=ev(s,i,l);e&&a.push(e)}i=l;let h=JSON.stringify(e);o!==h&&a.push(l),0===r&&(o=h)})}function c(e){return!!n.selectedPaths&&-1!==n.selectedPaths.indexOf(e)}return i===d.POINT?a.push(ey(s,r,o,c(o))):i===d.POLYGON?r.forEach((e,t)=>{u(e,null!==o?`${o}.${t}`:String(t))}):i===d.LINE_STRING?u(r,o):0===i.indexOf(d.MULTI_PREFIX)&&function(){let o=i.replace(d.MULTI_PREFIX,"");r.forEach((i,r)=>{let s={type:d.FEATURE,properties:t.properties,geometry:{type:o,coordinates:i}};a=a.concat(e(s,n,r))})}(),a},eE={enable(e){setTimeout(()=>{e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:eb,LAT_MAX:ex,LAT_RENDERED_MIN:eC,LAT_RENDERED_MAX:eO,LNG_MIN:eT,LNG_MAX:eS}=o;function eI(e,t){let n=eb,o=ex,i=eb,r=ex,s=eS,a=eT;return e.forEach(e=>{let t=function(e){let t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],n=[e.geometry.coordinates].flat(t),o=n.map(e=>e[0]),i=n.map(e=>e[1]),r=e=>Math.min.apply(null,e),s=e=>Math.max.apply(null,e);return[r(o),r(i),s(o),s(i)]}(e),u=t[1],c=t[3],l=t[0],h=t[2];u>n&&(n=u),c<o&&(o=c),c>i&&(i=c),u<r&&(r=u),l<s&&(s=l),h>a&&(a=h)}),n+t.lat>eO&&(t.lat=eO-n),i+t.lat>ex&&(t.lat=ex-i),o+t.lat<eC&&(t.lat=eC-o),r+t.lat<eb&&(t.lat=eb-r),s+t.lng<=eT&&(t.lng+=360*Math.ceil(Math.abs(t.lng)/360)),a+t.lng>=eS&&(t.lng-=360*Math.ceil(Math.abs(t.lng)/360)),t}function eL(e,t){let n=eI(e.map(e=>e.toGeoJSON()),t);e.forEach(e=>{let t;let o=e.getCoordinates(),i=e=>{let t={lng:e[0]+n.lng,lat:e[1]+n.lat};return[t.lng,t.lat]},r=e=>e.map(e=>i(e));e.type===d.POINT?t=i(o):e.type===d.LINE_STRING||e.type===d.MULTI_POINT?t=o.map(i):e.type===d.POLYGON||e.type===d.MULTI_LINE_STRING?t=o.map(r):e.type===d.MULTI_POLYGON&&(t=o.map(e=>e.map(e=>r(e)))),e.incomingCoords(t)})}let ew={};ew.onSetup=function(e){let t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(e=>void 0!==this.getFeature(e))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t},ew.fireUpdate=function(){this.fire(f.UPDATE,{action:g.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})},ew.fireActionable=function(){let e=this.getSelected(),t=e.filter(e=>this.isInstanceOf("MultiFeature",e)),n=!1;if(e.length>1){n=!0;let t=e[0].type.replace("Multi","");e.forEach(e=>{e.type.replace("Multi","")!==t&&(n=!1)})}let o=t.length>0,i=e.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:o,trash:i})},ew.getUniqueIds=function(e){return e.length?e.map(e=>e.properties.id).filter(e=>void 0!==e).reduce((e,t)=>(e.add(t),e),new A).values():[]},ew.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},ew.onStop=function(){eE.enable(this)},ew.onMouseMove=function(e,t){return ec(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0},ew.onMouseOut=function(e){return!e.dragMoving||this.fireUpdate()},ew.onTap=ew.onClick=function(e,t){return eu(t)?this.clickAnywhere(e,t):ei(m.VERTEX)(t)?this.clickOnVertex(e,t):ec(t)?this.clickOnFeature(e,t):void 0},ew.clickAnywhere=function(e){let t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(e=>this.doRender(e))),eE.enable(this),this.stopExtendedInteractions(e)},ew.clickOnVertex=function(e,t){this.changeMode(p.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:l.MOVE})},ew.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},ew.clickOnFeature=function(e,t){eE.disable(this),this.stopExtendedInteractions(e);let n=eh(t),o=this.getSelectedIds(),i=t.featureTarget.properties.id,r=this.isSelected(i);if(!n&&r&&this.getFeature(i).type!==d.POINT)return this.changeMode(p.DIRECT_SELECT,{featureId:i});r&&n?(this.deselect(i),this.updateUIClasses({mouse:l.POINTER}),1===o.length&&eE.enable(this)):!r&&n?(this.select(i),this.updateUIClasses({mouse:l.MOVE})):r||n||(o.forEach(e=>this.doRender(e)),this.setSelected(i),this.updateUIClasses({mouse:l.MOVE})),this.doRender(i)},ew.onMouseDown=function(e,t){return(e.initialDragPanState=this.map.dragPan.isEnabled(),es(t))?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&er(t)?this.startBoxSelect(e,t):void 0},ew.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=em(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},ew.onTouchStart=function(e,t){if(es(t))return this.startOnActiveFeature(e,t)},ew.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},ew.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:l.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(u.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));let n=em(t.originalEvent,this.map.getContainer()),o=Math.min(e.boxSelectStartLocation.x,n.x),i=Math.max(e.boxSelectStartLocation.x,n.x),r=Math.min(e.boxSelectStartLocation.y,n.y),s=Math.max(e.boxSelectStartLocation.y,n.y),a=`translate(${o}px, ${r}px)`;e.boxSelectElement.style.transform=a,e.boxSelectElement.style.WebkitTransform=a,e.boxSelectElement.style.width=`${i-o}px`,e.boxSelectElement.style.height=`${s-r}px`},ew.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();let n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};eL(this.getSelected(),n),e.dragMoveLocation=t.lngLat},ew.onTouchEnd=ew.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){let n=[e.boxSelectStartLocation,em(t.originalEvent,this.map.getContainer())],o=this.featuresAt(null,n,"click"),i=this.getUniqueIds(o).filter(e=>!this.isSelected(e));i.length&&(this.select(i),i.forEach(e=>this.doRender(e)),this.updateUIClasses({mouse:l.MOVE}))}this.stopExtendedInteractions(e)},ew.toDisplayFeatures=function(e,t,n){t.properties.active=this.isSelected(t.properties.id)?y.ACTIVE:y.INACTIVE,n(t),this.fireActionable(),t.properties.active===y.ACTIVE&&t.geometry.type!==d.POINT&&e_(t).forEach(n)},ew.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},ew.onCombineFeatures=function(){let e=this.getSelected();if(0===e.length||e.length<2)return;let t=[],n=[],o=e[0].type.replace("Multi","");for(let i=0;i<e.length;i++){let r=e[i];if(r.type.replace("Multi","")!==o)return;r.type.includes("Multi")?r.getCoordinates().forEach(e=>{t.push(e)}):t.push(r.getCoordinates()),n.push(r.toGeoJSON())}if(n.length>1){let e=this.newFeature({type:d.FEATURE,properties:n[0].properties,geometry:{type:`Multi${o}`,coordinates:t}});this.addFeature(e),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([e.id]),this.fire(f.COMBINE_FEATURES,{createdFeatures:[e.toGeoJSON()],deletedFeatures:n})}this.fireActionable()},ew.onUncombineFeatures=function(){let e=this.getSelected();if(0===e.length)return;let t=[],n=[];for(let o=0;o<e.length;o++){let i=e[o];this.isInstanceOf("MultiFeature",i)&&(i.getFeatures().forEach(e=>{this.addFeature(e),e.properties=i.properties,t.push(e.toGeoJSON()),this.select([e.id])}),this.deleteFeature(i.id,{silent:!0}),n.push(i.toGeoJSON()))}t.length>1&&this.fire(f.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:n}),this.fireActionable()};let eA=ei(m.VERTEX),eM=ei(m.MIDPOINT),eN={};eN.fireUpdate=function(){this.fire(f.UPDATE,{action:g.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})},eN.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},eN.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},eN.stopDragging=function(e){e.canDragMove&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},eN.onVertex=function(e,t){this.startDragging(e,t);let n=t.featureTarget.properties,o=e.selectedCoordPaths.indexOf(n.coord_path);eh(t)||-1!==o?eh(t)&&-1===o&&e.selectedCoordPaths.push(n.coord_path):e.selectedCoordPaths=[n.coord_path];let i=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(i)},eN.onMidpoint=function(e,t){this.startDragging(e,t);let n=t.featureTarget.properties;e.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),e.selectedCoordPaths=[n.coord_path]},eN.pathsToCoordinates=function(e,t){return t.map(t=>({feature_id:e,coord_path:t}))},eN.onFeature=function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},eN.dragFeature=function(e,t,n){eL(this.getSelected(),n),e.dragMoveLocation=t.lngLat},eN.dragVertex=function(e,t,n){let o=e.selectedCoordPaths.map(t=>e.feature.getCoordinate(t)),i=eI(o.map(e=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:e}})),n);for(let t=0;t<o.length;t++){let n=o[t];e.feature.updateCoordinate(e.selectedCoordPaths[t],n[0]+i.lng,n[1]+i.lat)}},eN.clickNoTarget=function(){this.changeMode(p.SIMPLE_SELECT)},eN.clickInactive=function(){this.changeMode(p.SIMPLE_SELECT)},eN.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},eN.onSetup=function(e){let t=e.featureId,n=this.getFeature(t);if(!n)throw Error("You must provide a featureId to enter direct_select mode");if(n.type===d.POINT)throw TypeError("direct_select mode doesn't handle point features");let o={featureId:t,feature:n,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,o.selectedCoordPaths)),this.setSelected(t),eE.disable(this),this.setActionableState({trash:!0}),o},eN.onStop=function(){eE.enable(this),this.clearSelectedCoordinates()},eN.toDisplayFeatures=function(e,t,n){e.featureId===t.properties.id?(t.properties.active=y.ACTIVE,n(t),e_(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(n)):(t.properties.active=y.INACTIVE,n(t)),this.fireActionable(e)},eN.onTrash=function(e){e.selectedCoordPaths.sort((e,t)=>t.localeCompare(e,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode(p.SIMPLE_SELECT,{}))},eN.onMouseMove=function(e,t){let n=es(t),o=eA(t),i=eM(t),r=0===e.selectedCoordPaths.length;return n&&r?this.updateUIClasses({mouse:l.MOVE}):o&&!r?this.updateUIClasses({mouse:l.MOVE}):this.updateUIClasses({mouse:l.NONE}),(o||n||i)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0},eN.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0},eN.onTouchStart=eN.onMouseDown=function(e,t){return eA(t)?this.onVertex(e,t):es(t)?this.onFeature(e,t):eM(t)?this.onMidpoint(e,t):void 0},eN.onDrag=function(e,t){if(!0!==e.canDragMove)return;e.dragMoving=!0,t.originalEvent.stopPropagation();let n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat},eN.onClick=function(e,t){return eu(t)?this.clickNoTarget(e,t):es(t)?this.clickActiveFeature(e,t):ea(t)?this.clickInactive(e,t):void this.stopDragging(e)},eN.onTap=function(e,t){return eu(t)?this.clickNoTarget(e,t):es(t)?this.clickActiveFeature(e,t):ea(t)?this.clickInactive(e,t):void 0},eN.onTouchEnd=eN.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};let eP={};eP.onSetup=function(){let e=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(h.POINT),this.setActionableState({trash:!0}),{point:e}},eP.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT)},eP.onTap=eP.onClick=function(e,t){this.updateUIClasses({mouse:l.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(f.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.point.id]})},eP.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},eP.toDisplayFeatures=function(e,t,n){let o=t.properties.id===e.point.id;if(t.properties.active=o?y.ACTIVE:y.INACTIVE,!o)return n(t)},eP.onTrash=eP.stopDrawingAndRemove,eP.onKeyUp=function(e,t){if(ed(t)||ep(t))return this.stopDrawingAndRemove(e,t)};let eR=function(e,t){return!!e.lngLat&&e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]},ek={};ek.onSetup=function(){let e=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),eE.disable(this),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(h.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},ek.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&eR(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:l.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)},ek.clickOnVertex=function(e){return this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},ek.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),el(t)&&this.updateUIClasses({mouse:l.POINTER})},ek.onTap=ek.onClick=function(e,t){return el(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},ek.onKeyUp=function(e,t){ed(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT)):ep(t)&&this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},ek.onStop=function(e){this.updateUIClasses({mouse:l.NONE}),eE.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(f.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT,{},{silent:!0})))},ek.toDisplayFeatures=function(e,t,n){let o=t.properties.id===e.polygon.id;if(t.properties.active=o?y.ACTIVE:y.INACTIVE,!o)return n(t);if(0===t.geometry.coordinates.length)return;let i=t.geometry.coordinates[0].length;if(!(i<3)){if(t.properties.meta=m.FEATURE,n(ey(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),i>3){let o=t.geometry.coordinates[0].length-3;n(ey(e.polygon.id,t.geometry.coordinates[0][o],`0.${o}`,!1))}if(i<=4){let e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(n({type:d.FEATURE,properties:t.properties,geometry:{coordinates:e,type:d.LINE_STRING}}),3===i)return}return n(t)}},ek.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT)};let eF={};eF.onSetup=function(e){let t,n;let o=(e=e||{}).featureId,i="forward";if(o){if(!(t=this.getFeature(o)))throw Error("Could not find a feature with the provided featureId");let r=e.from;if(r&&"Feature"===r.type&&r.geometry&&"Point"===r.geometry.type&&(r=r.geometry),r&&"Point"===r.type&&r.coordinates&&2===r.coordinates.length&&(r=r.coordinates),!r||!Array.isArray(r))throw Error("Please use the `from` property to indicate which point to continue the line from");let s=t.coordinates.length-1;if(t.coordinates[s][0]===r[0]&&t.coordinates[s][1]===r[1])n=s+1,t.addCoordinate(n,...t.coordinates[s]);else if(t.coordinates[0][0]===r[0]&&t.coordinates[0][1]===r[1])i="backwards",n=0,t.addCoordinate(n,...t.coordinates[0]);else throw Error("`from` should match the point at either the start or the end of the provided LineString")}else t=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(t);return this.clearSelectedFeatures(),eE.disable(this),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(h.LINE),this.setActionableState({trash:!0}),{line:t,currentVertexPosition:n,direction:i}},eF.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&eR(t,e.line.coordinates[e.currentVertexPosition-1])||"backwards"===e.direction&&eR(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:l.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),"forward"===e.direction?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},eF.clickOnVertex=function(e){return this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.line.id]})},eF.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),el(t)&&this.updateUIClasses({mouse:l.POINTER})},eF.onTap=eF.onClick=function(e,t){if(el(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},eF.onKeyUp=function(e,t){ep(t)?this.changeMode(p.SIMPLE_SELECT,{featureIds:[e.line.id]}):ed(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT))},eF.onStop=function(e){eE.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.line.id)&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(f.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT,{},{silent:!0})))},eF.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(p.SIMPLE_SELECT)},eF.toDisplayFeatures=function(e,t,n){let o=t.properties.id===e.line.id;if(t.properties.active=o?y.ACTIVE:y.INACTIVE,!o)return n(t);t.geometry.coordinates.length<2||(t.properties.meta=m.FEATURE,n(ey(e.line.id,t.geometry.coordinates["forward"===e.direction?t.geometry.coordinates.length-2:1],`${"forward"===e.direction?t.geometry.coordinates.length-2:1}`,!1)),n(t))};let eD={simple_select:ew,direct_select:eN,draw_point:eP,draw_polygon:ek,draw_line_string:eF},eU={defaultMode:p.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:eo,modes:eD,controls:{},userProperties:!1,suppressAPIEvents:!0},eB={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},eG={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function eV(e,t){return e.map(e=>e.source?e:Object.assign({},e,{id:`${e.id}.${t}`,source:"hot"===t?c.HOT:c.COLD}))}var ej=n(1616),eq=n(1403);function e$(e,t){return e.length===t.length&&JSON.stringify(e.map(e=>e).sort())===JSON.stringify(t.map(e=>e).sort())}let ez={Polygon:j,LineString:V,Point:G,MultiPolygon:z,MultiLineString:z,MultiPoint:z},eJ=function(e,t){let n={options:e=function(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),!1===e.displayControlsDefault?t.controls=Object.assign({},eG,e.controls):t.controls=Object.assign({},eB,e.controls),(t=Object.assign({},eU,t)).styles=eV(t.styles,"cold").concat(eV(t.styles,"hot")),t}(e)};t=function(e,t){t.modes=p;let n=void 0===e.options.suppressAPIEvents||!!e.options.suppressAPIEvents;return t.getFeatureIdsAt=function(t){return N.click({point:t},null,e).map(e=>e.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:d.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(t=>e.store.get(t)).map(e=>e.toGeoJSON())}},t.getSelectedPoints=function(){return{type:d.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(e=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:e.coordinates}}))}},t.set=function(n){if(void 0===n.type||n.type!==d.FEATURE_COLLECTION||!Array.isArray(n.features))throw Error("Invalid FeatureCollection");let o=e.store.createRenderBatch(),i=e.store.getAllIds().slice(),r=t.add(n),s=new A(r);return(i=i.filter(e=>!s.has(e))).length&&t.delete(i),o(),r},t.add=function(t){let o=JSON.parse(JSON.stringify(eq(t))).features.map(t=>{if(t.id=t.id||U(),null===t.geometry)throw Error("Invalid geometry: null");if(void 0===e.store.get(t.id)||e.store.get(t.id).type!==t.geometry.type){let o=ez[t.geometry.type];if(void 0===o)throw Error(`Invalid geometry type: ${t.geometry.type}.`);let i=new o(e,t);e.store.add(i,{silent:n})}else{let o=e.store.get(t.id),i=o.properties;o.properties=t.properties,ej(i,t.properties)||e.store.featureChanged(o.id,{silent:n}),ej(o.getCoordinates(),t.geometry.coordinates)||o.incomingCoords(t.geometry.coordinates)}return t.id});return e.store.render(),o},t.get=function(t){let n=e.store.get(t);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:d.FEATURE_COLLECTION,features:e.store.getAll().map(e=>e.toGeoJSON())}},t.delete=function(o){return e.store.delete(o,{silent:n}),t.getMode()!==p.DIRECT_SELECT||e.store.getSelectedIds().length?e.store.render():e.events.changeMode(p.SIMPLE_SELECT,void 0,{silent:n}),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:n}),t.getMode()===p.DIRECT_SELECT?e.events.changeMode(p.SIMPLE_SELECT,void 0,{silent:n}):e.store.render(),t},t.changeMode=function(o,i={}){return o===p.SIMPLE_SELECT&&t.getMode()===p.SIMPLE_SELECT?(e$(i.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(i.featureIds,{silent:n}),e.store.render()),t):(o===p.DIRECT_SELECT&&t.getMode()===p.DIRECT_SELECT&&i.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(o,i,{silent:n}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:n}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:n}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:n}),t},t.setFeatureProperty=function(o,i,r){return e.store.setFeatureProperty(o,i,r,{silent:n}),t},t}(n,t),n.api=t;let o=function(e){let t=null,n=null,o={onRemove(){return e.map.off("load",o.connect),clearInterval(n),o.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",o.connect),clearInterval(n),o.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(i){if(e.map=i,e.events=function(e){let t=Object.keys(e.options.modes).reduce((t,n)=>(t[n]=function(e){let t=Object.keys(e);return function(n,o={}){let i={},r=t.reduce((t,n)=>(t[n]=e[n],t),new J(n));return{start(){i=r.onSetup(o),Z.forEach(t=>{let n=H[t],o=()=>!1;e[n]&&(o=()=>!0),this.on(t,o,e=>r[n](i,e))})},stop(){r.onStop(i)},trash(){r.onTrash(i)},combineFeatures(){r.onCombineFeatures(i)},uncombineFeatures(){r.onUncombineFeatures(i)},render(e,t){r.toDisplayFeatures(i,e,t)}}}}(e.options.modes[n]),t),{}),n={},o={},i={},r=null,a=null;i.drag=function(t,n){n({point:t.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:l.DRAG}),a.drag(t)):t.originalEvent.stopPropagation()},i.mousedrag=function(e){i.drag(e,e=>!F(n,e))},i.touchdrag=function(e){i.drag(e,e=>!D(o,e))},i.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return i.mousedrag(t);let n=R(t,e);t.featureTarget=n,a.mousemove(t)},i.mousedown=function(t){n={time:new Date().getTime(),point:t.point};let o=R(t,e);t.featureTarget=o,a.mousedown(t)},i.mouseup=function(t){let o=R(t,e);t.featureTarget=o,F(n,{point:t.point,time:new Date().getTime()})?a.click(t):a.mouseup(t)},i.mouseout=function(e){a.mouseout(e)},i.touchstart=function(t){if(!e.options.touchEnabled)return;o={time:new Date().getTime(),point:t.point};let n=N.touch(t,null,e)[0];t.featureTarget=n,a.touchstart(t)},i.touchmove=function(t){if(e.options.touchEnabled)return a.touchmove(t),i.touchdrag(t)},i.touchend=function(t){if(t.originalEvent.preventDefault(),!e.options.touchEnabled)return;let n=N.touch(t,null,e)[0];t.featureTarget=n,D(o,{time:new Date().getTime(),point:t.point})?a.tap(t):a.touchend(t)};let c=e=>!(8===e||46===e||e>=48&&e<=57);function h(n,o,i={}){a.stop();let u=t[n];if(void 0===u)throw Error(`${n} is not valid`);r=n,a=s(u(e,o),e),i.silent||e.map.fire(f.MODE_CHANGE,{mode:n}),e.store.setDirty(),e.store.render()}i.keydown=function(t){(t.srcElement||t.target).classList.contains(u.CANVAS)&&((8===t.keyCode||46===t.keyCode)&&e.options.controls.trash?(t.preventDefault(),a.trash()):c(t.keyCode)?a.keydown(t):49===t.keyCode&&e.options.controls.point?h(p.DRAW_POINT):50===t.keyCode&&e.options.controls.line_string?h(p.DRAW_LINE_STRING):51===t.keyCode&&e.options.controls.polygon&&h(p.DRAW_POLYGON))},i.keyup=function(e){c(e.keyCode)&&a.keyup(e)},i.zoomend=function(){e.store.changeZoom()},i.data=function(t){if("style"===t.dataType){let{setup:t,map:n,options:o,store:i}=e;o.styles.some(e=>n.getLayer(e.id))||(t.addLayers(),i.setDirty(),i.render())}};let d={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start(){a=s(t[r=e.options.defaultMode](e),e)},changeMode:h,actionable:function(t){let n=!1;Object.keys(t).forEach(e=>{if(void 0===d[e])throw Error("Invalid action type");d[e]!==t[e]&&(n=!0),d[e]=t[e]}),n&&e.map.fire(f.ACTIONABLE,{actions:d})},currentModeName:()=>r,currentModeRender:(e,t)=>a.render(e,t),fire(t,n){e.map&&e.map.fire(t,n)},addEventListeners(){e.map.on("mousemove",i.mousemove),e.map.on("mousedown",i.mousedown),e.map.on("mouseup",i.mouseup),e.map.on("data",i.data),e.map.on("touchmove",i.touchmove),e.map.on("touchstart",i.touchstart),e.map.on("touchend",i.touchend),e.container.addEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",i.keydown),e.container.addEventListener("keyup",i.keyup))},removeEventListeners(){e.map.off("mousemove",i.mousemove),e.map.off("mousedown",i.mousedown),e.map.off("mouseup",i.mouseup),e.map.off("data",i.data),e.map.off("touchmove",i.touchmove),e.map.off("touchstart",i.touchstart),e.map.off("touchend",i.touchend),e.container.removeEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",i.keydown),e.container.removeEventListener("keyup",i.keyup))},trash(e){a.trash(e)},combineFeatures(){a.combineFeatures()},uncombineFeatures(){a.uncombineFeatures()},getMode:()=>r}}(e),e.ui=function(e){let t={},n=null,o={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function r(e){i=Object.assign(i,e)}function s(){if(!e.container)return;let t=[],n=[];Q.forEach(e=>{i[e]!==o[e]&&(t.push(`${e}-${o[e]}`),null!==i[e]&&n.push(`${e}-${i[e]}`))}),t.length>0&&e.container.classList.remove(...t),n.length>0&&e.container.classList.add(...n),o=Object.assign(o,i)}function a(e,t={}){let o=document.createElement("button");return o.className=`${u.CONTROL_BUTTON} ${t.className}`,o.setAttribute("title",t.title),t.container.appendChild(o),o.addEventListener("click",o=>{if(o.preventDefault(),o.stopPropagation(),o.target===n){c(),t.onDeactivate();return}l(e),t.onActivate()},!0),o}function c(){n&&(n.classList.remove(u.ACTIVE_BUTTON),n=null)}function l(e){c();let o=t[e];o&&o&&"trash"!==e&&(o.classList.add(u.ACTIVE_BUTTON),n=o)}return{setActiveButton:l,queueMapClasses:r,updateMapClasses:s,clearMapClasses:function(){r({mode:null,feature:null,mouse:null}),s()},addButtons:function(){let n=e.options.controls,o=document.createElement("div");return o.className=`${u.CONTROL_GROUP} ${u.CONTROL_BASE}`,n&&(n[h.LINE]&&(t[h.LINE]=a(h.LINE,{container:o,className:u.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(p.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),n[h.POLYGON]&&(t[h.POLYGON]=a(h.POLYGON,{container:o,className:u.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(p.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),n[h.POINT]&&(t[h.POINT]=a(h.POINT,{container:o,className:u.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(p.DRAW_POINT),onDeactivate:()=>e.events.trash()})),n.trash&&(t.trash=a("trash",{container:o,className:u.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),n.combine_features&&(t.combine_features=a("combineFeatures",{container:o,className:u.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),n.uncombine_features&&(t.uncombine_features=a("uncombineFeatures",{container:o,className:u.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),o},removeButtons:function(){Object.keys(t).forEach(e=>{let n=t[e];n.parentNode&&n.parentNode.removeChild(n),delete t[e]})}}}(e),e.container=i.getContainer(),e.store=new W(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=i.boxZoom.isEnabled(),i.boxZoom.disable();let t=i.dragPan.isEnabled();i.dragPan.disable(),i.dragPan.enable(),t||i.dragPan.disable()}return i.loaded()?o.connect():(i.on("load",o.connect),n=setInterval(()=>{i.loaded()&&o.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(c.COLD,{data:{type:d.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(c.HOT,{data:{type:d.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(t=>{e.map.addLayer(t)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(t=>{e.map.getLayer(t.id)&&e.map.removeLayer(t.id)}),e.map.getSource(c.COLD)&&e.map.removeSource(c.COLD),e.map.getSource(c.HOT)&&e.map.removeSource(c.HOT)}};return e.setup=o,o}(n);return t.onAdd=o.onAdd,t.onRemove=o.onRemove,t.types=h,t.options=e,t};function eH(e){eJ(e,this)}eH.modes=eD,eH.constants=o,eH.lib=r;let eZ=eH},662:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}e.exports=r,e.exports.once=function(e,t){return new Promise(function(n,o){var i,r,s;function a(n){e.removeListener(t,u),o(n)}function u(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}g(e,t,u,{once:!0}),"error"!==t&&(i=e,r=a,s={once:!0},"function"==typeof i.on&&g(i,"error",r,s))})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){if(a(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var i,r,s,c=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(o);return i.listener=n,o.wrapFn=i,i}function d(e,t,n){var o=e._events;if(void 0===o)return[];var i=o[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=Array(t),o=0;o<t;++o)n[o]=e[o];return n}function g(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else if("function"==typeof e.addEventListener)e.addEventListener(t,function i(r){o.once&&e.removeEventListener(t,i),n(r)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),r.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return u(this)},r.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var s,a=Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=r[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else for(var c=u.length,l=f(u,c),n=0;n<c;++n)o(l[n],this,t);return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,o,i,r,s;if(a(t),void 0===(o=this._events)||void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,i=r;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0==arguments.length){var i,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},r.prototype.listenerCount=p,r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},1018:(e,t,n)=>{"use strict";var o=n(4407),i=n(4052),r=n(9999),s=n(662).EventEmitter,a=n(1496),u=n(3434),c=n(6310),l=n(9603),h=n(8195),d=n(5344),p=n(2032),f=n(5943);let g={FORWARD:0,LOCAL:1,REVERSE:2};function m(e){this._eventEmitter=new s,this.options=r({},this.options,e),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new p}m.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(e){return e.place_name},render:function(e){var t=e.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"}},_headers:{},addTo:function(e){function t(e,t){if(!document.body.contains(t))throw Error("Element provided to #addTo() exists, but is not in the DOM");let n=e.onAdd();t.appendChild(n)}if(e._controlContainer)e.addControl(this);else if(e instanceof HTMLElement)t(this,e);else if("string"==typeof e){let n=document.querySelectorAll(e);if(0===n.length)throw Error("Element ",e,"not found.");if(n.length>1)throw Error("Geocoder can only be added to a single html element");t(this,n[0])}else throw Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(e){if(e&&"string"!=typeof e&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=c(u({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new l(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var t,n=this.container=document.createElement("div");n.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",i(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(e){this.eventManager.keyevent(e,this)}).bind(this));var s=document.createElement("div");s.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var a=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(a),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),s.appendChild(this._clearEl),s.appendChild(this._loadingEl),n.appendChild(r),n.appendChild(this._inputEl),n.appendChild(s),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var h=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(h),s.appendChild(this._geolocateEl),this._showGeolocateButton()}var d=this._typeahead=new o(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),d.getItemValue=this.options.getItemValue;var p=d.list.draw,f=this._footerNode=((t=document.createElement("div")).className="mapboxgl-ctrl-geocoder--powered-by",t.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',t);return d.list.draw=function(){p.call(this),f.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),f.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(f)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),n},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(e){this._hideLoadingIcon();let t={geometry:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]}};this._handleMarker(t),this._fly(t),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(t),this._showClearButton(),this.fresh=!1;let n={limit:1,language:[this.options.language],query:t.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){let e=t.geometry.coordinates[0]+","+t.geometry.coordinates[1];this._setInputValue(e),this._eventEmitter.emit("result",{result:t})}else this.geocoderService.reverseGeocode(n).send().then((function(e){let n=e.body.features[0];if(n){let e=f.transformFeatureToGeolocationText(n,this.options.addressAccuracy);this._setInputValue(e),n.user_coordinates=t.geometry.coordinates,this._eventEmitter.emit("result",{result:n})}else this._eventEmitter.emit("result",{result:{user_coordinates:t.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(e){1===e.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+e),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),n.innerHTML=t,n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(e){this._inputEl.value=e,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this._geocode(t)},_onKeyDown:function(e){if(27===e.keyCode&&this.options.clearAndBlurOnEsc)return this._clear(e),this._inputEl.blur();var t=e.target&&e.target.shadowRoot?e.target.shadowRoot.activeElement:e.target;if(!(t?t.value:""))return this.fresh=!0,9!==e.keyCode&&this.clear(e),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!e.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(e.keyCode)&&t.value.length>=this.options.minLength&&this._geocode(t.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()},_onChange:function(){var e=this._typeahead.selected;e&&JSON.stringify(e)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(e),this.options.marker&&this._mapboxgl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._eventEmitter.emit("result",{result:e}),this.eventManager.select(e,this))},_fly:function(e){var t;if(e.properties&&a[e.properties.short_code])t=r({},this.options.flyTo),this._map&&this._map.fitBounds(a[e.properties.short_code].bbox,t);else if(e.bbox){var n=e.bbox;t=r({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],t)}else t=r({},{zoom:this.options.zoom},this.options.flyTo),e.center?t.center=e.center:e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&(t.center=e.geometry.coordinates),this._map&&this._map.flyTo(t)},_requestType:function(e,t){var n;return e.localGeocoderOnly?g.LOCAL:e.reverseGeocode&&f.REVERSE_GEOCODE_COORD_RGX.test(t)?g.REVERSE:g.FORWARD},_setupConfig:function(e,t){let n=/[\s,]+/;var o=this,i=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce(function(e,t){if(void 0===o.options[t]||null===o.options[t])return e;["countries","types","language"].indexOf(t)>-1?e[t]=o.options[t].split(n):e[t]=o.options[t];let i="number"==typeof o.options[t].longitude&&"number"==typeof o.options[t].latitude;if("proximity"===t&&i){let n=o.options[t].longitude,i=o.options[t].latitude;e[t]=[n,i]}return e},{});switch(e){case g.REVERSE:var s=t.split(n).map(function(e){return parseFloat(e,10)});o.options.flipCoordinates||s.reverse(),i.types&&i.types[0],i=r(i,{query:s,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(e){e in i&&delete i[e]});break;case g.FORWARD:{let e=t.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(e)&&(t=t.replace(/,/g," ")),i=r(i,{query:t})}}return i.session_token=this.eventManager.getSessionId(),i},_geocode:function(e){this.inputString=e,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:e});let t=this._requestType(this.options,e),n=this._setupConfig(t,e);switch(t){case g.LOCAL:o=Promise.resolve();break;case g.FORWARD:o=this.geocoderService.forwardGeocode(n).send();break;case g.REVERSE:o=this.geocoderService.reverseGeocode(n).send()}var o,i=this.options.localGeocoder&&this.options.localGeocoder(e)||[],r=[],s=null;return o.catch((function(e){s=e}).bind(this)).then((function(t){this._hideLoadingIcon();var o={};return(t?"200"==t.statusCode&&((o=t.body).request=t.request,o.headers=t.headers,this._headers=t.headers):o={type:"FeatureCollection",features:[]},o.config=n,this.fresh&&(this.eventManager.start(this),this.fresh=!1),o.features&&o.features.length&&o.features.map(function(e){e._source="mapbox"}),o.features=o.features?i.concat(o.features):i,this.options.externalGeocoder)?(r=this.options.externalGeocoder(e,o.features)||Promise.resolve([])).then(function(e){return o.features=o.features?e.concat(o.features):e,o},function(){return o}):o}).bind(this)).then((function(e){if(s)throw s;this.options.filter&&e.features.length&&(e.features=e.features.filter(this.options.filter)),e.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",e),this._typeahead.update(e.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",e))}).bind(this)).catch((function(e){this._hideLoadingIcon(),this._hideAttribution(),i.length&&this.options.localGeocoder||r.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(i)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:i}),this._eventEmitter.emit("error",{error:e})}).bind(this)),o},_clear:function(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this.eventManager.sessionIncrementer++,this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(e){this._clear(e),this._inputEl.focus()},_clearOnBlur:function(e){e.relatedTarget&&this._clear(e)},_onQueryResult:function(e){var t=e.body;if(t.features.length){var n=t.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity){if(this._map.getZoom()>9){var e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat},!1)}else this.setProximity(null,!1)}},_collapse:function(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(e){return this._geocode(e).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var e=this.options.language.split(",")[0],t=d.language(e),n=h.placeholder[t];if(n)return n}return"Search"},setInput:function(e,t){return void 0===t&&(t=!1),this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&(t?this._geocode(e):this._onChange()),this},setProximity:function(e,t=!0){return this.options.proximity=e,t&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(e){return e&&"function"==typeof e&&(this._typeahead.render=e),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(e){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=e||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(e){return this.options.zoom=e,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(e){return this.options.flyTo=e,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(e){return this.options.placeholder=e||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(e){return this.options.bbox=e,this},getCountries:function(){return this.options.countries},setCountries:function(e){return this.options.countries=e,this},getTypes:function(){return this.options.types},setTypes:function(e){return this.options.types=e,this},getMinLength:function(){return this.options.minLength},setMinLength:function(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this},getLimit:function(){return this.options.limit},setLimit:function(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this},getFilter:function(){return this.options.filter},setFilter:function(e){return this.options.filter=e,this},setOrigin:function(e){return this.options.origin=e,this.geocoderService=c(u({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(e){return this.options.accessToken=e,this.geocoderService=c(u({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(e){return this.options.autocomplete=e,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(e){return this.options.fuzzyMatch=e,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(e){return this.options.routing=e,this},getRouting:function(){return this.options.routing},setWorldview:function(e){return this.options.worldview=e,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(e){if(this._map){this._removeMarker();var t=r({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(t),e.center?this.mapMarker.setLngLat(e.center).addTo(this._map):e.geometry&&e.geometry.type&&"Point"===e.geometry.type&&e.geometry.coordinates&&this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(e,t){return this._eventEmitter.on(e,t),this},off:function(e,t){return this._eventEmitter.removeListener(e,t),this.eventManager.remove(),this}},e.exports=m},1161:(e,t,n)=>{"use strict";var o=n(8339),i={};function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){if(i[e])return i[e];var t=e.split("."),n=t[0],s=t[1];if(!s)throw Error("Invalid token");var a=function(e){try{return JSON.parse(o.decode(e))}catch(e){throw Error("Invalid token")}}(s),u={usage:n,user:a.u};return r(a,"a")&&(u.authorization=a.a),r(a,"exp")&&(u.expires=1e3*a.exp),r(a,"iat")&&(u.created=1e3*a.iat),r(a,"scopes")&&(u.scopes=a.scopes),r(a,"client")&&(u.client=a.client),r(a,"ll")&&(u.lastLogin=a.ll),r(a,"iu")&&(u.impersonator=a.iu),i[e]=u,u}},1278:(e,t,n)=>{"use strict";var o=n(4378),i=n(9967);e.exports=function(e){return function(t){var n=o.prototype.isPrototypeOf(t)?t:i(t),r=Object.create(e);return r.client=n,r}}},1311:(e,t,n)=>{"use strict";n.d(t,{Ak:()=>o});let o=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")},1349:e=>{e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},1403:e=>{e.exports=function(e){if(!e||!e.type)return null;var n=t[e.type];return n?"geometry"===n?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]}:"feature"===n?{type:"FeatureCollection",features:[e]}:"featurecollection"===n?e:void 0:null};var t={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},1496:e=>{e.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},1616:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(i=o;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=o;0!=i--;){var o,i,r,s=r[i];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},1846:(e,t,n)=>{"use strict";var o=n(23);e.exports=function(e){return o(e,function(e,t){return"boolean"==typeof t?JSON.stringify(t):t})}},2032:e=>{function t(){}t.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){let e={enableHighAccuracy:!0};return new Promise(function(t,n){window.navigator.geolocation.getCurrentPosition(t,n,e)})}},e.exports=t},2056:e=>{"use strict";e.exports=function(e){return e?e.split(/,\s*</).reduce(function(e,t){var n=function(e){var t=e.match(/<?([^>]*)>(.*)/);if(!t)return null;var n=t[1],o=t[2].split(";"),i=null,r=o.reduce(function(e,t){var n,o=(n=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/))?{key:n[1],value:n[2]}:null;return o&&("rel"===o.key?i||(i=o.value):e[o.key]=o.value),e},{});return i?{url:n,rel:i,params:r}:null}(t);return n&&n.rel.split(/\s+/).forEach(function(t){e[t]||(e[t]={url:n.url,params:n.params})}),e},{}):{}}},2101:e=>{"use strict";function t(e){return Array.isArray(e)?e.map(encodeURIComponent).join(","):encodeURIComponent(String(e))}function n(e,n,o){if(!1===o||null===o)return e;var i=/\?/.test(e)?"&":"?",r=encodeURIComponent(n);return void 0!==o&&""!==o&&!0!==o&&(r+="="+t(o)),""+e+i+r}e.exports={appendQueryObject:function(e,t){if(!t)return e;var o=e;return Object.keys(t).forEach(function(e){var i=t[e];void 0!==i&&(Array.isArray(i)&&(i=i.filter(function(e){return null!=e}).join(",")),o=n(o,e,i))}),o},appendQueryParam:n,prependOrigin:function(e,t){if(!t||"http"===e.slice(0,4))return e;var n="/"===e[0]?"":"/";return""+t.replace(/\/$/,"")+n+e},interpolateRouteParams:function(e,n){return n?e.replace(/\/:([a-zA-Z0-9]+)/g,function(e,o){var i=n[o];if(void 0===i)throw Error("Unspecified route parameter "+o);return"/"+t(i)}):e}}},2661:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function o(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,o,r,s){if("function"!=typeof o)throw TypeError("The listener must be a function");var a=new i(o,r||e,s),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function a(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(n=!1)),a.prototype.eventNames=function(){var e,o,i=[];if(0===this._eventsCount)return i;for(o in e=this._events)t.call(e,o)&&i.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var i=0,r=o.length,s=Array(r);i<r;i++)s[i]=o[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},a.prototype.emit=function(e,t,o,i,r,s){var a=n?n+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,i),!0;case 5:return l.fn.call(l.context,t,o,i,r),!0;case 6:return l.fn.call(l.context,t,o,i,r,s),!0}for(c=1,u=Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var d,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,o);break;case 4:l[c].fn.call(l[c].context,t,o,i);break;default:if(!u)for(d=1,u=Array(h-1);d<h;d++)u[d-1]=arguments[d];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,o,i){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||i&&!a.once||o&&a.context!==o||s(this,r);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||i&&!a[u].once||o&&a[u].context!==o)&&c.push(a[u]);c.length?this._events[r]=1===c.length?c[0]:c:s(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new o,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},3434:(e,t,n)=>{"use strict";e.exports=n(9967)},3738:e=>{"use strict";e.exports=function(e,t){var n=function(e,n){return -1!==t.indexOf(e)&&void 0!==n};return"function"==typeof t&&(n=t),Object.keys(e).filter(function(t){return n(t,e[t])}).reduce(function(t,n){return t[n]=e[n],t},{})}},4052:(e,t,n)=>{var o=0/0,i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,h=c||l||Function("return this")(),d=Object.prototype.toString,p=Math.max,f=Math.min,g=function(){return h.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==d.call(t))return o;if(m(e)){var t,n="function"==typeof e.valueOf?e.valueOf():e;e=m(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var c=s.test(e);return c||a.test(e)?u(e.slice(2),c?2:8):r.test(e)?o:+e}e.exports=function(e,t,n){var o,i,r,s,a,u,c=0,l=!1,h=!1,d=!0;if("function"!=typeof e)throw TypeError("Expected a function");function v(t){var n=o,r=i;return o=i=void 0,c=t,s=e.apply(r,n)}function _(e){var n=e-u,o=e-c;return void 0===u||n>=t||n<0||h&&o>=r}function E(){var e,n,o,i=g();if(_(i))return b(i);a=setTimeout(E,(e=i-u,n=i-c,o=t-e,h?f(o,r-n):o))}function b(e){return(a=void 0,d&&o)?v(e):(o=i=void 0,s)}function x(){var e,n=g(),r=_(n);if(o=arguments,i=this,u=n,r){if(void 0===a)return c=e=u,a=setTimeout(E,t),l?v(e):s;if(h)return a=setTimeout(E,t),v(u)}return void 0===a&&(a=setTimeout(E,t)),s}return t=y(t)||0,m(n)&&(l=!!n.leading,r=(h="maxWait"in n)?p(y(n.maxWait)||0,t):r,d="trailing"in n?!!n.trailing:d),x.cancel=function(){void 0!==a&&clearTimeout(a),c=0,o=u=i=a=void 0},x.flush=function(){return void 0===a?s:b(g())},x}},4286:(e,t,n)=>{"use strict";var o=n(2056);function i(e,t){this.request=e,this.headers=t.headers,this.rawBody=t.body,this.statusCode=t.statusCode;try{this.body=JSON.parse(t.body||"{}")}catch(e){this.body=t.body}this.links=o(this.headers.link)}i.prototype.hasNextPage=function(){return!!this.links.next},i.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},e.exports=i},4378:(e,t,n)=>{"use strict";var o=n(1161),i=n(9842),r=n(4959);function s(e){if(!e||!e.accessToken)throw Error("Cannot create a client without an access token");o(e.accessToken),this.accessToken=e.accessToken,this.origin=e.origin||r.API_ORIGIN}s.prototype.createRequest=function(e){return new i(this,e)},e.exports=s},4386:e=>{"use strict";var t=function(e){return this.component=e,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};t.prototype.show=function(){this.element.style.display="block"},t.prototype.hide=function(){this.element.style.display="none"},t.prototype.add=function(e){this.items.push(e)},t.prototype.clear=function(){this.items=[],this.active=0},t.prototype.isEmpty=function(){return!this.items.length},t.prototype.isVisible=function(){return"block"===this.element.style.display},t.prototype.draw=function(){if(this.element.innerHTML="",0===this.items.length){this.hide();return}for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()},t.prototype.drawItem=function(e,t){var n=document.createElement("li"),o=document.createElement("a");t&&(n.className+=" active"),o.innerHTML=e.string,n.appendChild(o),this.element.appendChild(n),n.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),n.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,e)}).bind(this))},t.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()},t.prototype.move=function(e){this.active=e,this.draw()},t.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},t.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},t.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()},e.exports=t},4407:(e,t,n)=>{"use strict";var o=n(99);e.exports=o,"undefined"!=typeof window&&(window.Suggestions=o)},4481:(e,t,n)=>{"use strict";var o=n(4959);e.exports=function(e){var t,n=e.type||o.ERROR_HTTP;if(e.body)try{t=JSON.parse(e.body)}catch(n){t=e.body}else t=null;var i=e.message||null;i||("string"==typeof t?i=t:t&&"string"==typeof t.message?i=t.message:n!==o.ERROR_REQUEST_ABORTED||(i="Request aborted")),this.message=i,this.type=n,this.statusCode=e.statusCode||null,this.request=e.request,this.body=t}},4511:(e,t,n)=>{"use strict";var o=n(9999),i=n(5452);e.exports=o(i,{file:function(e){if("undefined"!=typeof window){if(e instanceof n.g.Blob||e instanceof n.g.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof e&&void 0===e.pipe)return"Filename or Readable stream"},date:function(e){var t="date";if("boolean"==typeof e)return t;try{var n=new Date(e);if(n.getTime&&isNaN(n.getTime()))return t}catch(e){return t}},coordinates:function(e){return i.tuple(i.number,i.number)(e)},assertShape:function(e,t){return i.assert(i.strictShape(e),t)}})},4959:e=>{"use strict";e.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},5344:function(e){var t;t=function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function t(t){return t.match(e)||[]}function n(e){return{language:(e=t(e))[1]||"",extlang:e[2]||"",script:e[3]||"",region:e[4]||""}}function o(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!0})}function i(e,i,r){function s(n){return t(n)[e]||""}o(s,"pattern",i),o(n,r,s)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),o(n,"split",function(e){return t(e).filter(function(e,t){return e&&t})}),n},e.exports?e.exports=t():this.subtag=t()},5452:(e,t,n)=>{"use strict";var o=n(6913),i=n(9999),r="value",s={};function a(e){var t=Array.isArray(e);return function(n){var o,i=u(s.plainArray,n);if(i)return i;if(t&&n.length!==e.length)return"an array with "+e.length+" items";for(var r=0;r<n.length;r++)if(i=u((o=r,t?e[o]:e),n[r]))return[r].concat(i)}}function u(e,t){if(null!=t||e.hasOwnProperty("__required")){var n=e(t);if(n)return Array.isArray(n)?n:[n]}}function c(e,t){var n,o=e.length,s=e[o-1],a=e.slice(0,o-1);return 0===a.length&&(a=[r]),t=i(t,{path:a}),"function"==typeof s?s(t):l(t,"must be "+(n=s,/^an? /.test(n)?n:/^[aeiou]/i.test(n)?"an "+n:/^[a-z]/i.test(n)?"a "+n:n)+".")}function l(e,t){return(h(e.path)?"Item at position ":"")+(e.path.join(".")+" "+t)}function h(e){return"number"==typeof e[e.length-1]||"number"==typeof e[0]}s.assert=function(e,t){return t=t||{},function(n){var o=u(e,n);if(o){var i=c(o,t);throw t.apiName&&(i=t.apiName+": "+i),Error(i)}}},s.shape=function(e){var t,n=Object.keys((t=e)||{}).map(function(e){return{key:e,value:t[e]}});return function(e){var t,o=u(s.plainObject,e);if(o)return o;for(var i=[],a=0;a<n.length;a++)t=n[a].key,(o=u(n[a].value,e[t]))&&i.push([t].concat(o));return i.length<2?i[0]:function(e){i=i.map(function(t){return"- "+t[0]+": "+c(t,e).split("\n").join("\n  ")});var t=e.path.join(".");return"The following properties"+(t===r?"":" of "+t)+" have invalid values:\n  "+i.join("\n  ")}}},s.strictShape=function(e){var t=s.shape(e);return function(n){var o=t(n);if(o)return o;var i=Object.keys(n).reduce(function(t,n){return void 0===e[n]&&t.push(n),t},[]);if(0!==i.length)return function(){return"The following keys are invalid: "+i.join(", ")}}},s.arrayOf=function(e){return a(e)},s.tuple=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return a(e)},s.required=function(e){function t(t){return null==t?function(e){return l(e,h(e.path)?"cannot be undefined/null.":"is required.")}:e.apply(this,arguments)}return t.__required=!0,t},s.oneOfType=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(t){var n,o=e.map(function(e){return u(e,t)}).filter(Boolean);return o.length!==e.length?void 0:o.every(function(e){return 1===e.length&&"string"==typeof e[0]})?(n=o.map(function(e){return e[0]})).length<2?n[0]:2===n.length?n.join(" or "):n.slice(0,-1).join(", ")+", or "+n.slice(-1):o.reduce(function(e,t){return t.length>e.length?t:e})}},s.equal=function(e){return function(t){if(t!==e)return JSON.stringify(e)}},s.oneOf=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),t=e.map(function(e){return s.equal(e)});return s.oneOfType.apply(this,t)},s.range=function(e){var t=e[0],n=e[1];return function(e){if(u(s.number,e)||e<t||e>n)return"number between "+t+" & "+n+" (inclusive)"}},s.any=function(){},s.boolean=function(e){if("boolean"!=typeof e)return"boolean"},s.number=function(e){if("number"!=typeof e)return"number"},s.plainArray=function(e){if(!Array.isArray(e))return"array"},s.plainObject=function(e){if(!o(e))return"object"},s.string=function(e){if("string"!=typeof e)return"string"},s.func=function(e){if("function"!=typeof e)return"function"},s.validate=u,s.processMessage=c,e.exports=s},5943:e=>{function t(e){let t=e.address||"",n=e.text||"",o=e.place_name||"",i={address:o.split(",")[0],houseNumber:t,street:n,placeName:o};return e.context.forEach(function(e){i[e.id.split(".")[0]]=e.text}),i}e.exports={transformFeatureToGeolocationText:function(e,n){var o;let i=t(e),r=["address","street","place","country"];if("function"==typeof n)return n(i);let s=r.indexOf(n);return(-1===s?r:r.slice(s)).reduce(function(e,t){return i[t]?(""!==e&&(e+=", "),e+i[t]):e},"")},getAddressInfo:t,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},6027:(e,t,n)=>{var o=n(1349);function i(e){var t=0;if(e&&e.length>0){t+=Math.abs(r(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(r(e[n]))}return t}function r(e){var t,n,i,r,a,u,c=0,l=e.length;if(l>2){for(u=0;u<l;u++)u===l-2?(i=l-2,r=l-1,a=0):u===l-1?(i=l-1,r=0,a=1):(i=u,r=u+1,a=u+2),t=e[i],n=e[r],c+=(s(e[a][0])-s(t[0]))*Math.sin(s(n[1]));c=c*o.RADIUS*o.RADIUS/2}return c}function s(e){return e*Math.PI/180}e.exports.geometry=function e(t){var n,o=0;switch(t.type){case"Polygon":return i(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)o+=i(t.coordinates[n]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)o+=e(t.geometries[n]);return o}},e.exports.ring=r},6310:(e,t,n)=>{"use strict";var o=n(9999),i=n(4511),r=n(3738),s=n(1846),a=n(1278),u={},c=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];u.forwardGeocode=function(e){i.assertShape({query:i.required(i.string),mode:i.oneOf("mapbox.places","mapbox.places-permanent"),countries:i.arrayOf(i.string),proximity:i.oneOf(i.coordinates,"ip"),types:i.arrayOf(i.oneOf(c)),autocomplete:i.boolean,bbox:i.arrayOf(i.number),limit:i.number,language:i.arrayOf(i.string),routing:i.boolean,fuzzyMatch:i.boolean,worldview:i.string,session_token:i.string})(e),e.mode=e.mode||"mapbox.places";var t=s(o({country:e.countries},r(e,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:r(e,["mode","query"]),query:t})},u.reverseGeocode=function(e){i.assertShape({query:i.required(i.coordinates),mode:i.oneOf("mapbox.places","mapbox.places-permanent"),countries:i.arrayOf(i.string),types:i.arrayOf(i.oneOf(c)),bbox:i.arrayOf(i.number),limit:i.number,language:i.arrayOf(i.string),reverseMode:i.oneOf("distance","score"),routing:i.boolean,worldview:i.string,session_token:i.string})(e),e.mode=e.mode||"mapbox.places";var t=s(o({country:e.countries},r(e,["country","types","bbox","limit","language","reverseMode","routing","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:r(e,["mode","query"]),query:t})},e.exports=a(u)},6913:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var n;return"[object Object]"===t.call(e)&&(null===(n=Object.getPrototypeOf(e))||n===Object.getPrototypeOf({}))}},7062:e=>{!function(){var t={};e.exports=t,t.simpleFilter=function(e,n){return n.filter(function(n){return t.test(e,n)})},t.test=function(e,n){return null!==t.match(e,n)},t.match=function(e,t,n){n=n||{};var o,i=0,r=[],s=t.length,a=0,u=0,c=n.pre||"",l=n.post||"",h=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var d=0;d<s;d++)o=t[d],h[d]===e[i]?(o=c+o+l,i+=1,u+=1+u):u=0,a+=u,r[r.length]=o;return i===e.length?(a=h===e?1/0:a,{rendered:r.join(""),score:a}):null},t.filter=function(e,n,o){return n&&0!==n.length?"string"!=typeof e?n:(o=o||{},n.reduce(function(n,i,r,s){var a=i;o.extract&&(a=o.extract(i));var u=t.match(e,a,o);return null!=u&&(n[n.length]={string:u.rendered,score:u.score,index:r,original:i}),n},[]).sort(function(e,t){var n=t.score-e.score;return n||e.index-t.index})):[]}}()},7219:()=>{},8195:e=>{"use strict";e.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"ძიება",nb:"S\xf8ke",sk:"Vyhľad\xe1vanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"}}},8339:function(e,t,n){var o,i,r,s,a,u,c;(e=n.nmd(e))&&e.exports,(i="object"==typeof n.g&&n.g).global===i||i.window,(r=function(e){this.message=e}).prototype=Error(),r.prototype.name="InvalidCharacterError",s=function(e){throw new r(e)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,c={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,o,i=e.length%3,r="",u=-1,c=e.length-i;++u<c;)t=e.charCodeAt(u)<<16,o=t+(n=e.charCodeAt(++u)<<8)+e.charCodeAt(++u),r+=a.charAt(o>>18&63)+a.charAt(o>>12&63)+a.charAt(o>>6&63)+a.charAt(63&o);return 2==i?(o=(t=e.charCodeAt(u)<<8)+(n=e.charCodeAt(++u)),r+=a.charAt(o>>10)+a.charAt(o>>4&63)+a.charAt(o<<2&63)+"="):1==i&&(o=e.charCodeAt(u),r+=a.charAt(o>>2)+a.charAt(o<<4&63)+"=="),r},decode:function(e){var t,n,o=(e=String(e).replace(u,"")).length;o%4==0&&(o=(e=e.replace(/==?$/,"")).length),(o%4==1||/[^+a-zA-Z0-9/]/.test(e))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var i=0,r="",c=-1;++c<o;)n=a.indexOf(e.charAt(c)),t=i%4?64*t+n:n,i++%4&&(r+=String.fromCharCode(255&t>>(-2*i&6)));return r},version:"0.1.0"},void 0!==(o=(function(){return c}).call(t,n,t,e))&&(e.exports=o)},8905:(e,t,n)=>{"use strict";var o=n(4286),i=n(4481),r=n(4959),s=n(8980),a={};function u(e){var t=e.total,n=e.loaded;return{total:t,transferred:n,percent:100*n/t}}function c(e,t){return new Promise(function(n,o){t.onprogress=function(t){e.emitter.emit(r.EVENT_PROGRESS_DOWNLOAD,u(t))};var s=e.file;s&&(t.upload.onprogress=function(t){e.emitter.emit(r.EVENT_PROGRESS_UPLOAD,u(t))}),t.onerror=function(e){o(e)},t.onabort=function(){o(new i({request:e,type:r.ERROR_REQUEST_ABORTED}))},t.onload=function(){if(delete a[e.id],t.status<200||t.status>=400){o(new i({request:e,body:t.response,statusCode:t.status}));return}n(t)};var c=e.body;"string"==typeof c?t.send(c):c?t.send(JSON.stringify(c)):s?t.send(s):t.send(),a[e.id]=t}).then(function(t){return new o(e,{body:t.response,headers:s(t.getAllResponseHeaders()),statusCode:t.status})})}function l(e,t){var n=e.url(t),o=new window.XMLHttpRequest;return o.open(e.method,n),Object.keys(e.headers).forEach(function(t){o.setRequestHeader(t,e.headers[t])}),o}e.exports={browserAbort:function(e){var t=a[e.id];t&&(t.abort(),delete a[e.id])},sendRequestXhr:c,browserSend:function(e){return Promise.resolve().then(function(){var t=l(e,e.client.accessToken);return c(e,t)})},createRequestXhr:l}},8980:e=>{"use strict";e.exports=function(e){var t={};return e&&e.trim().split(/[\r|\n]+/).forEach(function(e){var n,o=(n=e.indexOf(":"),{name:e.substring(0,n).trim().toLowerCase(),value:e.substring(n+1).trim()});t[o.name]=o.value}),t}},9603:(e,t,n)=>{"use strict";var o=n(1311).Ak;function i(e){this.origin=e.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=e.accessToken,this.version="0.3.0",this.pluginSessionID=this.generateSessionID(),this.sessionIncrementer=0,this.userAgent=this.getUserAgent(),this.options=e,this.send=this.send.bind(this),this.countries=e.countries?e.countries.split(","):null,this.types=e.types?e.types.split(","):null,this.bbox=e.bbox?e.bbox:null,this.language=e.language?e.language.split(","):null,this.limit=e.limit?+e.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(e),this.eventQueue=[],this.flushInterval=e.flushInterval||1e3,this.maxQueueSize=e.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}i.prototype={select:function(e,t){var n=this.getEventPayload("search.select",t,{selectedFeature:e});if(n){if(n.resultIndex===this.lastSentIndex&&n.queryString===this.lastSentInput||-1==n.resultIndex)return;return this.lastSentIndex=n.resultIndex,this.lastSentInput=n.queryString,this.push(n)}},start:function(e){var t=this.getEventPayload("search.start",e);if(t)return this.push(t)},keyevent:function(e,t){if(e.key&&!e.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(e.keyCode)){var n=this.getEventPayload("search.keystroke",t,{key:e.key});if(n)return this.push(n)}},send:function(e,t){if(!this.enableEventLogging)return t?t():void 0;var n=this.getRequestOptions(e);this.request(n,(function(e){return e?this.handleError(e,t):t?t():void 0}).bind(this))},getRequestOptions:function(e){return Array.isArray(e)||(e=[e]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}},getEventPayload:function(e,t,n={}){if("search.select"===e&&!n.selectedFeature||"search.keystroke"===e&&!n.key)return null;if(t.options.proximity){if("object"==typeof t.options.proximity)o=[t.options.proximity.longitude,t.options.proximity.latitude];else if("ip"===t.options.proximity){var o,i=t._headers?t._headers["ip-proximity"]:null;o=i&&"string"==typeof i?i.split(",").map(parseFloat):[999,999]}else o=t.options.proximity}else o=null;var r=t._map?t._map.getZoom():void 0,s={event:e,version:this.getEventSchemaVersion(e),created:+new Date,sessionIdentifier:this.getSessionId(),country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:t.options.autocomplete,fuzzyMatch:t.options.fuzzyMatch,proximity:o,limit:t.options.limit,routing:t.options.routing,worldview:t.options.worldview,mapZoom:r,keyboardLocale:this.locale};if("search.select"===e?s.queryString=t.inputString:"search.select"!=e&&t._inputEl?s.queryString=t._inputEl.value:s.queryString=t.inputString,["search.keystroke","search.select"].includes(e)&&(s.path="geocoding/v5/mapbox.places"),"search.keystroke"===e&&n.key)s.lastAction=n.key;else if("search.select"===e&&n.selectedFeature){var a=n.selectedFeature;if(s.resultIndex=this.getSelectedIndex(a,t),s.resultPlaceName=a.place_name,s.resultId=a.id,a.properties&&(s.resultMapboxId=a.properties.mapbox_id),t._typeahead){var u=t._typeahead.data;u&&u.length>0&&(s.suggestionIds=this.getSuggestionIds(u),s.suggestionNames=this.getSuggestionNames(u),s.suggestionTypes=this.getSuggestionTypes(u),s.suggestionSources=this.getSuggestionSources(u))}}return this.validatePayload(s)?s:null},request:function(e,t){var n=new XMLHttpRequest;for(var o in n.onreadystatechange=function(){if(4==this.readyState)return 204==this.status?t(null):t(this.statusText)},n.open(e.method,e.host+"/"+e.path,!0),e.headers){var i=e.headers[o];n.setRequestHeader(o,i)}n.send(e.body)},handleError:function(e,t){if(t)return t(e)},generateSessionID:function(){return o()},getSessionId:function(){return this.pluginSessionID+"."+this.sessionIncrementer},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(e,t){if(t._typeahead){var n=t._typeahead.data,o=e.id;return n.map(function(e){return e.id}).indexOf(o)}},getSuggestionIds:function(e){return e.map(function(e){return e.properties?e.properties.mapbox_id||"":e.id||""})},getSuggestionNames:function(e){return e.map(function(e){return e.place_name||""})},getSuggestionTypes:function(e){return e.map(function(e){return e.place_type&&Array.isArray(e.place_type)&&e.place_type[0]||""})},getSuggestionSources:function(e){return e.map(function(e){return e._source||""})},getEventSchemaVersion:function(e){return["search.keystroke","search.select"].includes(e)?"2.2":"2.0"},validatePayload:function(e){if(!e||!e.event)return!1;var t=e.event;return"search.start"===t?this.objectHasRequiredProps(e,["event","created","sessionIdentifier","queryString"]):"search.keystroke"===t?this.objectHasRequiredProps(e,["event","created","sessionIdentifier","queryString","lastAction"]):"search.select"!==t||this.objectHasRequiredProps(e,["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"])},objectHasRequiredProps:function(e,t){return t.every(function(t){return"queryString"===t?"string"==typeof e[t]&&e[t].length>0:void 0!==e[t]})},shouldEnableLogging:function(e){return!1!==e.enableEventLogging&&(!e.origin||"https://api.mapbox.com"===e.origin)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=[]),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(e,t){this.eventQueue.push(e),(this.eventQueue.length>=this.maxQueueSize||t)&&this.flush()},remove:function(){this.flush()}},e.exports=i},9842:(e,t,n)=>{"use strict";var o=n(1161),i=n(9999),r=n(2661),s=n(2101),a=n(4959),u=1;function c(e,t){if(!e)throw Error("MapiRequest requires a client");if(!t||!t.path||!t.method)throw Error("MapiRequest requires an options object with path and method properties");var n={};t.body&&(n["content-type"]="application/json");var o=i(n,t.headers),s=Object.keys(o).reduce(function(e,t){return e[t.toLowerCase()]=o[t],e},{});this.id=u++,this._options=t,this.emitter=new r,this.client=e,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=t.path,this.method=t.method,this.origin=t.origin||e.origin,this.query=t.query||{},this.params=t.params||{},this.body=t.body||null,this.file=t.file||null,this.encoding=t.encoding||"utf8",this.sendFileAs=t.sendFileAs||null,this.headers=s}c.prototype.url=function(e){var t=s.prependOrigin(this.path,this.origin);t=s.appendQueryObject(t,this.query);var n=this.params,r=null==e?this.client.accessToken:e;return r&&(t=s.appendQueryParam(t,"access_token",r),n=i({ownerId:o(r).user},n)),t=s.interpolateRouteParams(t,n)},c.prototype.send=function(){var e=this;if(e.sent)throw Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return e.sent=!0,e.client.sendRequest(e).then(function(t){return e.response=t,e.emitter.emit(a.EVENT_RESPONSE,t),t},function(t){throw e.error=t,e.emitter.emit(a.EVENT_ERROR,t),t})},c.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},c.prototype.eachPage=function(e){var t=this;function n(n){e(null,n,function(){delete t._nextPageRequest;var e=n.nextPage();e&&(t._nextPageRequest=e,i(e))})}function o(t){e(t,null,function(){})}function i(e){e.send().then(n,o)}i(this)},c.prototype.clone=function(){return this._extend()},c.prototype._extend=function(e){var t=i(this._options,e);return new c(this.client,t)},e.exports=c},9967:(e,t,n)=>{"use strict";var o=n(8905),i=n(4378);function r(e){i.call(this,e)}r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.sendRequest=o.browserSend,r.prototype.abortRequest=o.browserAbort,e.exports=function(e){return new r(e)}},9999:e=>{e.exports=function(){for(var e={},n=0;n<arguments.length;n++){var o=arguments[n];for(var i in o)t.call(o,i)&&(e[i]=o[i])}return e};var t=Object.prototype.hasOwnProperty}}]);